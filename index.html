<!DOCTYPE html>
<html lang="en">
    <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Doodle Doo</title>

        <!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" 
        integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous"> -->
        <!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" 
        integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
        <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" 
        integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous"> -->
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">
        <link href="style.css" rel="stylesheet" type='text/css'>
    </head>

    <body>
        
       
        <div id="canvas-container">  

                <div class="control"> 
                        <div class="fa fa-paint-brush" id="clear-canvas">Clear</div>
                        <div class="fa fa-paint-brush" id="undo">Undo</div>
                        <div class="fa fa-paint-brush" id="redo">Redo</div>
                        <a href="#" id="btn-download" download="my-drawing.png"><div class="fa fa-paint-brush">Save</div></a>
                </div>
    
            <!-- canvas section -->           
            <canvas id="canvas-real" class="canvas" width='960px' height='540px'></canvas>
            <canvas id="canvas-draft" class="canvas" width='960px' height='540px' usemap="#planetmap"></canvas>
            <map name="planetmap">
                <area id='top-left'  shape="rect" coords="0,0,10,10"  >
                <area id='top-right'  shape="rect" coords="0,0,10,10"  >
                <area id='bottom-left'  shape="rect" coords="0,0,10,10"  >
                <area id='bottom-right'  shape="rect" coords="0,0,10,10"  >
            </map>
        

        <!-- tool-bar for shapes, brush, color and eraser -->
        <div id="tool-bar">
           
            <div class="tool-plate hide">
                <div class="tool-slide"><div>0</div> <input type="range" id="opacity" min="0" max="10" value="10">
                <div>100%</div></div>
                <div class="colorbox">
                    <div><i class="fas fa-pencil-alt"></i></div> <div><input type="color" class="line-color" id="color-picker"></div>
                </div>
                <div class="colorbox">
                    <div><i class="fas fa-fill-drip"></i></div> <div><input type="color" class="fill-color" id="color-picker"></div>
                </div>
                
            </div>
            <div class="tool-plate hide">
                <div class="tool-icon"><i class="far fa-vector-square fa-2x" id="drawing-rectangle" ></i></div>
                <div class="tool-icon"><i class="fas fa-ruler fa-2x" id="drawing-line"></i></div>
                <div class="tool-icon"><i class="far fa-circle fa-2x" id="drawing-circle"></i> </div>
                <div class="tool-icon"><i class="fas fa-draw-polygon fa-2x" id="drawing-polygon"></i></div>
            </div>
            <div class="tool-plate hide">
                <div class="tool-slide"><div>0</div><input type="range" id="brush-width" min="1" max="50" value="10"><div>50</div></div>
                <div class="tool-icon"><i class="fas fa-pencil-alt fa-2x" id="drawing-normal"></i></div>
                <div class="tool-icon"><span class="btn btn-info fa fa-paint-brush" id="worm" >Pom pom</span></div>
                <div class="tool-icon"><span class="btn btn-info fa fa-paint-brush" id="wire" >Wire</span></div>
                <div class="tool-icon"><i class="fas fa-spray-can fa-2x" id="spray"></i></div>
                
            </div>
            <div class="tool-plate hide">
                <div class="tool-icon"><i class="fas fa-eraser fa-3x" id="wipe"></i></div>
            </div>
            <div class="tool-plate hide">
                <div class="tool-icon"><i class="fas fa-font fa-3x" id="drawing-text"></i></div>
            </div>
         <div id="tool-box"><i class="fas fa-box fa-10x"></i></div>
        </div>
       
        </div>
        


        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
        <script type='text/javascript' src="https://code.jquery.com/jquery-3.2.1.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" 
        integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
        <script type='text/javascript' src="./javascript/canvas-common.js"></script>
        <script type='text/javascript' src="./javascript/editDrawingArea.js"></script>
        <script type='text/javascript' src="./javascript/drawing-line.js"></script>
        <script type='text/javascript' src="./javascript/drawing-rectangle.js"></script>
        <script type='text/javascript' src="./javascript/drawing-text.js"></script>
        <script type='text/javascript' src="./javascript/drawing-normal.js"></script>
        <script type='text/javascript' src="./javascript/drawing-circle.js"></script>
        <script type='text/javascript' src="./javascript/drawing-polygon.js"></script>
        <script type='text/javascript' src="./javascript/Wipe.js"></script>
        <script type='text/javascript' src="./javascript/brush.js"></script>
        <script type='text/javascript' src="./javascript/SprayPaint.js"></script>
        <script type='text/javascript' src="./javascript/artbrush.js"></script>
        <script type='text/javascript' src="./javascript/uiux.js"></script>
        <script type='text/javascript' src="./javascript/undo-redo.js"></script>
        <script type='text/javascript' src="./javascript/save-btn.js"></script>
        <script type='text/javascript'>

        $(function () {
            // var funqueue = [];

            // var canvas = document.getElementById('canvas-real');
            /*
            if (canvas.getContext){
                var ctx = canvas.getContext('2d');

                ctx.beginPath();
                ctx.moveTo(50,50);
                ctx.lineTo(100,100);
                ctx.lineTo(100,50);
                
                ctx.lineTo(50,100);
                ctx.fill();
            }
            

            function dragWithCustomImage(event) {
                var canvas = document.createElementNS("http://www.w3.org/1999/xhtml","canvas");
                canvas.width = canvas.height = 50;

                var ctx = canvas.getContext("2d");
                ctx.lineWidth = 4;
                ctx.moveTo(0, 0);
                ctx.lineTo(50, 50);
                ctx.moveTo(0, 50);
                ctx.lineTo(50, 0);
                ctx.stroke();

                var dt = event.dataTransfer;
                dt.setData('text/plain', 'Data to Drag');
                dt.setDragImage(canvas, 25, 25);
            }
            */


            $('#drawing-rectangle').click(() => {
                graphicArea.reset();
                needFinishGraphic();
                currentFunction = new DrawingRectangle(contextReal,contextDraft);
            });
            $('#drawing-line').click(() => {
                graphicArea.reset();
                needFinishGraphic();
                currentFunction = new DrawingLine(contextReal,contextDraft);
            });

            $('#spray').click(()=>{
                if (currentFunction.endDrawing){
                    
                }
                graphicArea.reset();
                needFinishGraphic();
                currentFunction = new SprayPaint(contextReal);
            });

            $('#wire').click(()=>{
                if (currentFunction.endDrawing){
                }
                graphicArea.reset();
                needFinishGraphic();
                currentFunction = new ArtBrush(contextReal,10,1,5);
            });

            $('#worm').click(()=>{
                if (currentFunction.endDrawing){
                }
                graphicArea.reset();
                needFinishGraphic();
                currentFunction = new ArtBrush(contextReal,20,32,5);
            });

            $('#drawing-text').click(() => {
                if (currentFunction.endDrawing) {
                    //need to maintain
                    //currentFunction.drawLine(currentFunction.contextReal,null);
                }
                //currentFunction = new DrawingText(contextReal,contextDraft);
                graphicArea.reset();
            });
            $('#drawing-normal').click(() => {
                graphicArea.reset();
                needFinishGraphic();
                currentFunction = new DrawingNormal(contextReal,contextDraft);
            });
            $('#drawing-circle').click(() => {
                graphicArea.reset();
                needFinishGraphic();
                currentFunction = new DrawingCircle(contextReal,contextDraft);
            });
            $('#drawing-polygon').click(() => {
                graphicArea.reset();
                needFinishGraphic();
                currentFunction = new DrawingPolygon(contextReal,contextDraft);
            });
            $('#wipe').click(() => {
                graphicArea.reset();
                needFinishGraphic();
                currentFunction = new Wipe(contextReal,contextDraft);
            });
            $('#clear-canvas').click(() => {
                graphicArea.reset();
                currentFunction.reset();
                contextReal.clearRect(0, 0, canvasDraft.width, canvasDraft.height);

                // canvas needs a background colour!
                contextReal.fillStyle = '#fff';
                contextReal.fillRect(0, 0, canvasDraft.width, canvasDraft.height);
                canvasArray.push(canvasReal.toDataURL());

                canvasArray = new Array();
                canvasStep = -1;

                canvasPush();
            });
            currentFunction = new DrawingNormal(contextReal,contextDraft);    
            
            function needFinishGraphic(){
                switch (true) {
                    case currentFunction instanceof Wipe:
                        break;
                    case currentFunction instanceof SprayPaint:
                        break;
                    case currentFunction instanceof ArtBrush:
                        break;
                    default:
                        if(currentFunction.endDrawing){
                            currentFunction.finishGraphic();
                            canvasPush();
                        }
                        
                        break;
                }
            }
            canvasPush();
        })

    </script>
</body>

</html>